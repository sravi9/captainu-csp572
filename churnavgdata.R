monthlydata<-read.csv('C:/Users/sshss-pc/Desktop/project/processed/monthlydata.csv', header = TRUE)
names(monthlydata)[1]<-"athlete_id"
monthlytest<-monthlydata[1:1000,]
churnavg<-function(df){
  row<-nrow(df)
  result<-replace(df,values = "NA")
  names(result)[8]<-"avgmonthlypros"
  names(result)[11]<-"avgmonthlyevents"
  names(result)[14]<-"avgmonthlyemails"
  names(result)[17]<-"avgmonthlymsgreceived"
  names(result)[20]<-"avgmonthlymsgsent"
  names(result)[23]<-"avgmonthlyvid"
  current<-1
  v28<-0
  v29<-0
  v30<-0
  v31<-0
  v32<-0
  v33<-0
  v34<-0
  v35<-0
  v36<-0
  v37<-0
  v38<-0
  v39<-0
  v40<-0
  v41<-0
  v42<-0
  v43<-0
  v44<-0
  v45<-0
  v46<-0
  v47<-0
  v48<-0
  v49<-0
  for(n in 1:(row-1)){
    if(df[n,1]==df[n+1,1]){
      v28<-v28+df[n,28]
      v29<-v29+df[n,29]
      v30<-v30+df[n,30]
      v31<-v31+df[n,31]
      v32<-v32+df[n,32]
      v33<-v33+df[n,33]
      v34<-v34+df[n,34]
      v35<-v35+df[n,35]
      v36<-v36+df[n,36]
      v37<-v37+df[n,37]
      v38<-v38+df[n,38]
      v39<-v39+df[n,39]
      v40<-v40+df[n,40]
      v41<-v41+df[n,41]
      v42<-v42+df[n,42]
      v43<-v43+df[n,43]
      v44<-v44+df[n,44]
      v45<-v45+df[n,45]
      v46<-v46+df[n,46]
      v47<-v47+df[n,47]
      v48<-v48+df[n,48]
      v49<-v49+df[n,49]
    }
    if(df[n,1]!=df[n+1,1]){
      result[current,]<-df[n,]
      result[current,28]<-v28
      result[current,29]<-v29
      result[current,30]<-v30
      result[current,31]<-v31
      result[current,32]<-v32
      result[current,33]<-v33
      result[current,34]<-v34
      result[current,35]<-v35
      result[current,36]<-v36
      result[current,37]<-v37
      result[current,38]<-v38
      result[current,39]<-v39
      result[current,40]<-v40
      result[current,41]<-v42
      result[current,42]<-v42
      result[current,43]<-v43
      result[current,44]<-v44
      result[current,45]<-v45
      result[current,46]<-v46
      result[current,47]<-v47
      result[current,48]<-v48
      result[current,49]<-v49
      result[current,8]<-df[n,7]/df[n,3]
      result[current,11]<-df[n,10]/df[n,3]
      result[current,14]<-df[n,13]/df[n,3]
      result[current,17]<-df[n,16]/df[n,3]
      result[current,20]<-df[n,19]/df[n,3]
      result[current,23]<-df[n,22]/df[n,3]
      current<-current+1
      v28<-0
      v29<-0
      v30<-0
      v31<-0
      v32<-0
      v33<-0
      v34<-0
      v35<-0
      v36<-0
      v37<-0
      v38<-0
      v39<-0
      v40<-0
      v41<-0
      v42<-0
      v43<-0
      v44<-0
      v45<-0
      v46<-0
      v47<-0
      v48<-0
      v49<-0
    }
  }
  return(result)
}

resulttest<-churnavg(monthlytest)
churnavgdata<-churnavg(monthlydata)
write.csv(churnavgdata,"C:/Users/sshss-pc/Desktop/churnavgdata.csv")
